From 55968d72d1571ac34fae2a2842f5577b1300d51b Mon Sep 17 00:00:00 2001
From: David Tardon <dtardon@redhat.com>
Date: Mon, 9 Dec 2013 11:10:15 +0100
Subject: [PATCH] CID#1130378 rearrange a bit

Change-Id: I2e8470ca67b8ee43f843bdd1cdc1ce949e9df05a
---
 src/lib/KEYMemoryStream.cpp | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/lib/KEYMemoryStream.cpp b/src/lib/KEYMemoryStream.cpp
index dfa6bbb..5fbd182 100644
--- a/src/lib/KEYMemoryStream.cpp
+++ b/src/lib/KEYMemoryStream.cpp
@@ -166,9 +166,11 @@ void KEYMemoryStream::read(const RVNGInputStreamPtr_t &input, const unsigned len
 {
   if (0 == length)
     return;
+  if (!bool(input))
+    throw EndOfStreamException();
 
   unsigned long readBytes = 0;
-  const unsigned char *const data = bool(input) ? input->read(length, readBytes) : 0;
+  const unsigned char *const data = input->read(length, readBytes);
   if (length != readBytes)
     throw EndOfStreamException();
 
-- 
1.9.3

